"use strict";var U=Object.create;var l=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var M=(e,n)=>{for(var r in n)l(e,r,{get:n[r],enumerable:!0})},S=(e,n,r,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of O(n))!D.call(e,o)&&o!==r&&l(e,o,{get:()=>n[o],enumerable:!(s=v(n,o))||s.enumerable});return e};var m=(e,n,r)=>(r=e!=null?U($(e)):{},S(n||!e||!e.__esModule?l(r,"default",{value:e,enumerable:!0}):r,e)),W=e=>S(l({},"__esModule",{value:!0}),e);var G={};M(G,{default:()=>L});module.exports=W(G);var t=require("@raycast/api"),a=m(require("fs/promises")),I=m(require("os")),g=m(require("path")),c=require("react");var P=require("@raycast/api");var E=m(require("os"));var k=require("@raycast/api"),u=m(require("fs"));function C(e){return e instanceof Error?e.message:"unknown error"}async function p(e){return u.promises.access(e,u.constants.F_OK).then(()=>!0).catch(()=>!1)}var Z=new Intl.NumberFormat("en",{notation:"compact"});function j(e){return new Promise(n=>setTimeout(n,e))}async function F(e,n=2e3){let r=new Date;for(;r.getTime()>0;){if(await j(10),await p(e))return!0;if(new Date().getTime()-r.getTime()>n)return!1}return!1}function h(e){return`${f()}://tonka3000.raycast/${e}`}async function b(e){await(0,k.open)(h(e))}var J=process.platform==="win32";var te={Code:`${E.homedir()}\\AppData\\Local\\Programs\\Microsoft VS Code\\bin\\code.cmd`,"Code - Insiders":`${E.homedir()}\\AppData\\Local\\Programs\\Microsoft VS Code Insiders\\bin\\code-insiders.cmd`};function w(){return(0,P.getPreferenceValues)().build}var R={Antigravity:"antigravity",Code:"vscode","Code - Insiders":"vscode-insiders",Cursor:"cursor",Kiro:"kiro",VSCodium:"vscode-oss",Positron:"positron",Windsurf:"windsurf",Trae:"trae","Trae CN":"trae-cn"};function f(){let e=R[w()];return!e||e.length<=0?R.Code:e}var i=require("react/jsx-runtime");function B(){let e=w();return g.default.join(I.homedir(),`Library/Application Support/${e}/User/globalStorage/tonka3000.raycast/transit`)}function q(e){let n=e.command,r=n.category?`${n.category}: ${n.title}`:n.title;return(0,i.jsx)(t.Action.CreateQuicklink,{shortcut:{modifiers:["cmd"],key:"l"},quicklink:{link:h(`runcommand?cmd=${n.command}`),name:`VSCode - ${r}`}})}async function K(){let e=B();await a.mkdir(e,{recursive:!0});let n=g.default.join(e,"request.json"),r=g.default.join(e,"commands.json");if(await a.writeFile(n,JSON.stringify({command:"writecommands",args:{filename:r}},null,2)),await p(r)&&await a.rm(r),await F(r))return await Q(r);throw new Error("Could not get VSCode commands")}function _(e){let n=e.command,r=o=>o.category?`${o.category}: ${o.title}`:o.title,s=async()=>{try{await b(`runcommand?cmd=${n.command}`),(0,t.popToRoot)()}catch(o){(0,t.showToast)({style:t.Toast.Style.Failure,title:"Could not run Command",message:C(o)})}};return(0,i.jsx)(t.List.Item,{title:r(n),actions:(0,i.jsxs)(t.ActionPanel,{children:[(0,i.jsxs)(t.ActionPanel.Section,{children:[(0,i.jsx)(t.Action,{title:"Run Command",onAction:s,icon:{source:t.Icon.Terminal}}),(0,i.jsx)(q,{command:n})]}),(0,i.jsx)(t.ActionPanel.Section,{children:(0,i.jsx)(t.Action.CopyToClipboard,{shortcut:{modifiers:["cmd","shift"],key:"."},title:"Copy Command ID",content:n.command})})]})})}function H(){return(0,i.jsx)(t.Action.OpenInBrowser,{title:"Install Raycast for VS Code",url:`${f()}:extension/tonka3000.raycast`,onOpen:()=>{(0,t.popToRoot)(),(0,t.showHUD)("Open VSCode Extension")}})}function L(){let{isLoading:e,commands:n,error:r,refresh:s}=z();return r&&(0,t.showToast)({style:t.Toast.Style.Failure,title:"Error",message:r}),(0,i.jsxs)(t.List,{isLoading:e,searchBarPlaceholder:e===!0?"Load Commands from VSCode":"Search Commands",children:[(0,i.jsx)(t.List.Section,{title:"Commands",subtitle:`${n?.length}`,children:n?.map(o=>(0,i.jsx)(_,{command:o},o.command))}),r&&(0,i.jsx)(t.List.EmptyView,{title:"No Response from Raycast for VSCode extension",icon:"\u26A0\uFE0F",actions:(0,i.jsxs)(t.ActionPanel,{children:[(0,i.jsx)(t.Action,{title:"Reload",icon:t.Icon.RotateClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:s}),(0,i.jsx)(H,{})]})})]})}async function Q(e){let n=await a.readFile(e,"utf-8"),r=JSON.parse(n);return await a.rm(e),r}function z(){let[e,n]=(0,c.useState)(!0),[r,s]=(0,c.useState)(),[o,x]=(0,c.useState)(),[A,N]=(0,c.useState)(new Date),V=()=>{N(new Date)};return(0,c.useEffect)(()=>{let d=!1;async function T(){if(!d){n(!0),x(void 0);try{let y=await K();d||s(y)}catch(y){d||x(C(y))}finally{d||n(!1)}}}return T(),()=>{d=!0}},[A]),{commands:r,isLoading:e,error:o,refresh:V}}
